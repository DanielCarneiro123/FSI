# CTF Semana 11 (Weak Encryption)

Começamos por descarregar o ficheiro fornecido na plantaforma e analisa-lo.

E tal como sugere no enunciado, tivemos primeiro de procurar os valores p e q primos, que sabemos que são por volta de 2^512 e 2^513. E para isso criamos uma função:

![](images/ctf11_1.png)

Fomos ao servidor na porta 6004 e usamos os dados que nos deram.

```
e = 65537
n = 359538626972463181545861038157804946723595395788461314546860162315465351611001926265416954644815072042240227759742786715317579537628833244985694861278975882247679398542353192618125741451360923211862406826921499797811811920350907343267014884010176462291170177028894944230704078629434854490330312409849988021223
criptografy= 
3731336266313736323536396132333639373430333839306431363563653438353637343536323432633035333333376435363862643838346635646665643231333763636636633136353763383533643965393530643664613662306463616534393231323965313536666165623131336232313135326464323866363335326239666137363030303730353530306330653038666234643463336231646465303432653565613264373563396130356563653938363838663361316431373966633362393136613866646233343233336530373461386539383838633061366566666538303361633534313435663266653332333937376532626464306230303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030303030
```

Tendo isto e tendo o p e o q, fomos à procura do d que é o único que falta. Sobre este era sabido que:
```
(d * e) % ((p - 1) * (q - 1)) == 1
```

Que também é equivalente a:

```
d = pow(e, -1, (p - 1) * (q - 1))
```

Tendo agora tudo, só basta trocarmos no código fornecido, correr o ficheiro e chegamos à flag:

![](images/ctf11_1.png)
